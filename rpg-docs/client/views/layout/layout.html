<template name="layout">

	<core-drawer-panel>
		<core-header-panel drawer navigation flex mode="seamed" class="white">
			<div id="accountSummary" class="padded white-text">
				{{#if loggingIn}}
					<paper-spinner active alt="Signing In"></paper-spinner>
				{{else}}{{#if currentUser}}
					{{#with currentUser}}
						<div class="body2">
							{{username}}
						</div>
						<div class="body1">
							{{#each emails}}
								{{address}}
							{{/each}}
							<paper-menu-button>
								<paper-icon-button icon="arrow-drop-down" noink></paper-icon-button>
								<paper-dropdown class="dropdown">
									<core-menu class="menu">
										<paper-item id="signOutButton">Sign Out</paper-item>
									</core-menu>
								</paper-dropdown>
							</paper-menu-button>
						</div>
					{{/with}}
				{{else}}
						<h2>Sign In</h2>
						<paper-input class="fullwidth" label="Email" id="emailInput"></paper-input><br>
						<paper-input-decorator class="fullwidth" label="Password">
							<input class="fullwidth" type="password" is="core-input" id="passwordInput">
						</paper-input-decorator><br>
					{{#if session "creatingNewUser"}}
						<paper-button raised id="createAccountButton">Create Account</paper-button>
					{{else}}
						<paper-button raised id="signInButton">Sign In</paper-button>
					{{/if}}
				{{/if}}{{/if}}
			</div>
			<core-menu theme="core-light-theme">
				<paper-item id="charactersMenuButton">Characters</paper-item>
			</core-menu>
		</core-header-panel>
		<core-animated-pages main 
							 navigation 
							 detail-pages 
							 transitions="hero-transition cross-fade"
							 selected={{globalDetailSelected}}>
			<section id="mainContentSection" class={{notSelected}}>
				<core-header-panel fit mode="seamed">
					{{> yield}}
				</core-header-panel>
				<div>
					<div id="fadeDummy" cross-fade></div>
				</div>
			</section>
			<section id="detailSection">
				<div id="detailScreenFiller">
					<div id="screenDim" cross-fade></div>
					<paper-shadow id="globalDetail" z="5" animated hero hero-id="main">
						{{#if globalDetailTemplate}}
							{{> UI.dynamic template=globalDetailTemplate data=globalDetailData}}
						{{/if}}
					</paper-shadow>
				</div>
			</section>
		</core-animated-pages>
	</core-drawer-panel>

	<paper-action-dialog global-dialog backdrop
						 transition="core-transition-center"
						 class="scrolling {{#if globalDialogFullOnMobile}}full-on-mobile{{/if}}"
						 heading={{globalDialogHeader}}
						 layered>
		{{#if globalDialogTemplate}}
			{{> UI.dynamic template=globalDialogTemplate data=globalDialogData}}
		{{/if}}
	</paper-action-dialog>

	<paper-toast global-toast duration="5000">
		{{#if globalToastTemplate}}
			{{> UI.dynamic template=globalToastTemplate data=globalToastData}}
		{{else}}
			<div>
				No Toast template defined
			</div>
		{{/if}}
	</paper-toast>
</template>